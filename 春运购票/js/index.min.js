$(function(){function o(){$(n.ellipse).css({opacity:1}).addClass("fadeIn");n.goupiao.css({opacity:1}).addClass("animated lightSpeedIn").css("-webkit-animation-delay","1100ms");n.gonglue.css({opacity:1}).addClass("animated lightSpeedIn1").css("-webkit-animation-delay","1100ms").off("webkitAnimationEnd").on("webkitAnimationEnd",function(){n.ticket.css({opacity:1}).addClass("tic_move");n.goupiao.removeClass("animated lightSpeedIn");n.gonglue.removeClass("animated lightSpeedIn1");n.cus.css({opacity:1}).addClass("cus_move").off("webkitTransitionEnd").on("webkitTransitionEnd",function(){n.index.find(".info span").css({opacity:1}).css("-webkit-animation","shake1 1s ease-out infinite alternate")})})}function s(){n.goupiao.css("-webkit-transform","translate3d("+n.iWidth+"px,0,0)");n.gonglue.css("-webkit-transform","translate3d(-"+n.iWidth+"px,0,0)");$(n.ellipse).css("-webkit-transform","scale(0)").css({opacity:0});n.ticket.css({opacity:0}).css("-webkit-transition","1200ms 2s").css("-webkit-transform","translate3d(-"+n.iWidth+"px,0,0)");n.cus.css("-webkit-transition","1200ms 2100ms").css("-webkit-transform","translate3d(-"+n.iWidth+"px,0,0)").css({opacity:0}).on("webkitTransitionEnd",function(){});setTimeout(function(){c(function(){l()})},3300)}function h(){}function c(t){n.xhIn.each(function(n){$(this).addClass("active").css("-webkit-transition-delay",n*200+"ms")});n.xhIn.eq(1).on("webkitTransitionEnd",function(){n.xhIn.eq(1).off("webkitTransitionEnd");t&&t()})}function l(){var i=n.xiaoxin.find("img"),t=0;n.talkChangeTimer=setInterval(function(){t++;n.talk.css("-webkit-transform","translate3d(0,-200%,0)").css({background:"url(images/talk"+(t+1)+".png) no-repeat center",backgroundSize:"contain"});t>=2&&(clearInterval(n.talkChangeTimer),clearInterval(n.personChangeTimer),i.attr("src","images/xh-1.png"),n.info.find("span").css("-webkit-animation-play-state","running"),n.info.css({opacity:1}),n.info.find("img").attr("src",n.info.find("img").data("src")),n.info.css({opacity:1}).css("-webkit-transition","1s opacity linear"));setTimeout(function(){n.talk.css("-webkit-transform","translate3d(0,0,0)")},500)},4e3)}function a(){n.main.find("p").css({opacity:1}).addClass("animated bigEntrance");n.main.find(".link").css({opacity:1}).addClass("slideRight").css("-webkit-animation-delay","200ms").off("webkitAnimationEnd").on("webkitAnimationEnd",function(){n.nav.each(function(n){$(this).css({opacity:1}).addClass("animated bigEntrance").css("-webkit-animation-delay",n*500+"ms")});n.nav.eq(-1).on("webkitAnimationEnd",function(){n.nav.each(function(){$(this).removeClass("animated bigEntrance")})})})}function u(t,i,r){function a(n){var t=n.find("img"),i;t.attr("src")!==t.data("src")&&(i=t.attr("src"),t.attr("src",t.data("src")),t.data("src",i))}var c,h,e,v;t===n.xiaoxinTalk&&t.find(".train").css({opacity:1}).find("img").css("-webkit-animation","train_move 5s linear infinite !important");var o=t.find(".ticker"),u=t.find(".customer"),s=t.find(".talk_content img").css({opacity:1});s.attr("src",s.data("_src"));c=t.find(".continue");c.css({opacity:0});var y=t.find(".back"),f=u.width(),f=u.width(),l=null;t===n.xiaoxinTalk||(h=setInterval(function(){a(u)},300));o.width(f*.8);e=0;v=setInterval(function(){if(e>i)return clearInterval(v),clearInterval(l),clearInterval(h),s.css({opacity:0}),o.width(f),u.width(f),c.css({opacity:1}),e=0,y.css({opacity:1}).css("-webkit-animation","shake1 1s linear infinite alternate"),!1;s.css({opacity:1});e%2==0?(t===n.xiaoxinTalk?u.find("img").attr("src","images/xh-2.png"):clearInterval(h),l=setInterval(function(){a(o)},300),o.width(f),u.width(f*.8)):(clearInterval(l),t===n.xiaoxinTalk?u.find("img").attr("src","images/xx.gif"):h=setInterval(function(){a(u)},300),o.width(f*.8),u.width(f));s.attr("src","images/"+r+(e+2)+".png");e++},4e3)}function v(){u(n.xiaoxinTalk,2,"scene-talk")}function y(){u(n.xxxinTalk,2,"scene2-talk")}function p(){u(n.xdjTalk,4,"scene3-talk")}var n={iWidth:document.documentElement.clientWidth,iHeight:document.documentElement.clientHeight,canvas:$("#canvas"),index:$("#index"),goupiao:$("#goupiao"),main:$("#main"),gonglue:$("#gonglue"),person:$("#index .person"),xiaoxin:$("#index .xiaoxin"),home:$("#home"),talk:$("#index .talk"),ticket:$("#ticket"),xhIn:$("#index .xhIn"),cus:$("#cus"),nav:$("#main .nav"),info:$("#index .info"),personChangeTimer:null,talkChangeTimer:null,xiaoxinTalk:$("#xiaoxinTalk"),xxxinTalk:$("#xxxinTalk"),xdjTalk:$("#xdjTalk"),reunion:$("#reunion"),back:$(".back"),continues:$(".continue"),team:$("#team"),copyright:$("#copyright"),introduce:$("#main .introduce"),ellipse:$("#ellipse")[0],imgArr:["images/1.png","images/2.png","images/3.png","images/4.png","images/continue.png","images/copr.png","images/cus.png","images/diagram-link.png","images/ellipse.png","images/gonglue.png","images/goupiao.png","images/index.png","images/info.png","images/link.png","images/lt_loading.png","images/nav-bj.png","images/person.png","images/rail.png","images/return.png","images/rub.png","images/scene2-talk1.png","images/scene2-talk2.png","images/scene2-talk3.png","images/scene2-talk4.png","images/scene3-talk1.png","images/scene3-talk2.png","images/scene3-talk3.png","images/scene3-talk4.png","images/scene3-talk5.png","images/scene3-talk6.png","images/scene-talk1.png","images/scene-talk2.png","images/scene-talk3.png","images/scene-talk4.png","images/start.png","images/talk1.png","images/talk2.png","images/talk3.png","images/ticket.png","images/ticket1.png","images/ticket-seller1.png","images/ticket-seller2.png","images/ticket-seller3.png","images/ticket-seller4.png","images/ticket-seller5.png","images/ticket-seller6.png","images/train.png","images/xdj1.png","images/xdj2.png","images/xdj-summary.png","images/xh-1.png","images/xh-2.png","images/xh-3.png","images/xiaoxin.png","images/xx-summary.png","images/xxx1.png","images/xxx2.png","images/xxx-summary.png"],diagram:$("#diagram"),animate:["lightSpeedIn","slideDown","slideUp","slideLeft","slideRight","slideExpandUp","expandUp","fadeIn","expandOpen","bigEntrance","hatch","bounce","pulse","floating","pullUp","pullDown","stretchLeft","stretchRight","tada","flip","rubberBand","zoomOutUp"]},e=sessionStorage.getItem("key"),i,f,r,t;e==="tujie"?(n.reunion.css("-webkit-transform","translate3d(0,0,0)").css({zIndex:10}),$("#loading").css({opacity:0})):(i=1e5+Math.floor(Math.random()*1e3),$("meta[name='sharecontent']").data("msgContent","你是小新购票手册，我是第"+i+"位浏览者。"),init(n.reunion[0],innerWidth,innerHeight,"rgba(0,0,0,.8)",function(){n.reunion.find("span").html(i);setTimeout(function(){n.team.css({zIndex:10});$("#canvasTag").remove();$("#diagram").css({zIndex:10})},1e4)}));sessionStorage.setItem("key","");n.diagram.tap(function(){sessionStorage.setItem("key","tujie")});ltUtil.ltLoading(n.imgArr,function(){$("#loading").css("-webkit-transform","translate3d(0,-100%,0)").off("webkitTransitionEnd").on("webkitTransitionEnd",function(){$("img").each(function(){$(this).attr("src")!==$(this).data("_src")&&$(this).attr("src",$(this).data("_src"))});o()})},{id:"loading"});h(n.iWidth,n.iHeight);$(n.ellipse).css({left:(n.iWidth-n.canvas.width())/2});n.ellipse.width=n.canvas.width();n.ellipse.height=n.canvas.width()-90;f=n.ellipse.getContext("2d");r=new Image;r.onload=function(){f.drawImage(this,0,0,n.ellipse.width,n.ellipse.height)};r.src="images/ellipse.png";n.back.each(function(){$(this).tap(function(t,i){n.main.css("-webkit-transform","translate3d(0,0,0)");$(i).parent().css("-webkit-transform","translate3d(0,-100%,0)")})});n.team.tap(function(t,i){$(i).css({zIndex:10});n.reunion.css("-webkit-transform","translate3d(0,-100%,0)");$("#copyright").addClass("show").css({zIndex:11})});n.continues.each(function(){$(this).tap(function(t,i){$(i).parent().css("-webkit-transform","translate3d(0,-100%,0)");n.reunion.css("-webkit-transform","translate3d(0,0,0)")})});t=!0;n.info.tap(function(){t?(s(),n.info.find("span").css("-webkit-animation-play-state","paused"),n.info.css({opacity:0}).css("-webkit-transition","1s opacity linear")):(n.index.css("-webkit-transform","translate3d(0,-100%,0)"),n.main.addClass("show"),a());t=!t});n.nav.each(function(t){$(this).tap(function(){n.main.css("-webkit-transform","translate3d(0,-100%,0)");switch(t){case 0:n.xiaoxinTalk.css("-webkit-transform","translate3d(0,0,0)");v();break;case 1:n.xxxinTalk.css("-webkit-transform","translate3d(0,0,0)");y();break;case 2:n.xdjTalk.css("-webkit-transform","translate3d(0,0,0)");p()}})});$(document).on("touchmove",function(){return!1})}),function(){function i(n,t,i){var r={};return r.node=document.createElement("canvas"),r.context=r.node.getContext("2d"),r.node.width=t||320,r.node.height=i||480,r.node.id="canvasTag",n.appendChild(r.node),r}function r(n,t,r,u,f){var e=i(n,t,r),o=e.context,s;o.fillCircle=function(n,t,i,r){this.fillStyle=r;this.beginPath();this.moveTo(n,t);this.arc(n,t,i,0,Math.PI*2,!1);this.fill()};o.clearTo=function(){var n=new Image;n.onload=function(){o.drawImage(this,0,0,t,r)};n.src="images/rub.png"};o.clearTo(u||"#ddd");s=0;e.node.addEventListener("touchstart",function(){s++;s===1&&f&&f();e.isDrawing=!0},!1);e.node.addEventListener("touchend",function(){e.isDrawing=!1},!1);e.node.addEventListener("touchmove",function(n){if(n.preventDefault&&n.preventDefault(),e.isDrawing){var t=n.changedTouches[0].pageX-this.offsetLeft,i=n.changedTouches[0].pageY-this.offsetTop;o.globalCompositeOperation="destination-out";o.fillCircle(t,i,20,"#ff0000")}},!1)}var n,t,u;window.onload=function(){document.ontouchmove=function(n){n.preventDefault()};try{document.createElement("canvas").getContext("2d")}catch(n){var t=document.createElement("div");alert("您的手机不支持刮刮卡效果哦~!")}};n=navigator.userAgent;t="PC";n.indexOf("iPhone")>-1&&(t="iphone");(n.indexOf("Android")>-1||n.indexOf("Linux")>-1)&&(t="Android");u=document.getElementById("reunion");window.init=r}();
/*
//# sourceMappingURL=index.min.js.map
*/